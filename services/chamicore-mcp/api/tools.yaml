version: "1.0"
service: "chamicore-mcp"
apiVersion: "mcp/v1"
generated: "2026-02-25"
description: >
  V1 MCP tool contract for Chamicore agent control. This contract defines tool names,
  capability class (read/write), required scopes metadata, and input/output schemas.

defaults:
  mode: read-only
  modeGuard:
    read-only:
      allowedCapabilities: [read]
    read-write:
      allowedCapabilities: [read, write]
      requireExplicitWriteEnable: true
  destructiveConfirmation:
    field: confirm
    requiredFor:
      - pattern: "*.delete"
      - tool: power.transitions.abort
      - tool: power.transitions.create
        when:
          operationIn:
            - ForceOff
            - GracefulShutdown
            - GracefulRestart
            - ForceRestart
            - Nmi

tools:
  - name: cluster.health_summary
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties: {}
    outputSchema:
      type: object
      additionalProperties: false
      required: [services]
      properties:
        services:
          type: array
          items:
            type: object
            additionalProperties: false
            required: [name, health, readiness]
            properties:
              name: {type: string}
              health: {type: string}
              readiness: {type: string}
              detail: {type: string}

  - name: smd.components.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
        type: {type: string}
        state: {type: string}
        role: {type: string}
    outputSchema:
      type: object
      additionalProperties: true

  - name: smd.components.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: smd.groups.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: smd.groups.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [label]
      properties:
        label: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: smd.groups.members.add
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [label, members]
      properties:
        label: {type: string, minLength: 1}
        members:
          type: array
          minItems: 1
          items: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: smd.groups.members.remove
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [label, members]
      properties:
        label: {type: string, minLength: 1}
        members:
          type: array
          minItems: 1
          items: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: bss.bootparams.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: bss.bootparams.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [component_id]
      properties:
        component_id: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: bss.bootparams.upsert
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [component_id, kernel, initrd]
      properties:
        component_id: {type: string, minLength: 1}
        role: {type: string}
        kernel: {type: string, minLength: 1}
        initrd: {type: string, minLength: 1}
        params:
          type: array
          items: {type: string}
    outputSchema:
      type: object
      additionalProperties: true

  - name: bss.bootparams.delete
    capability: write
    requiredScopes: [admin]
    confirmationRequired: true
    inputSchema:
      type: object
      additionalProperties: false
      required: [component_id, confirm]
      properties:
        component_id: {type: string, minLength: 1}
        confirm: {type: boolean, const: true}
    outputSchema:
      type: object
      additionalProperties: true

  - name: cloudinit.payloads.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: cloudinit.payloads.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [component_id]
      properties:
        component_id: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: cloudinit.payloads.upsert
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [component_id, user_data]
      properties:
        component_id: {type: string, minLength: 1}
        role: {type: string}
        user_data: {type: string, minLength: 1}
        meta_data: {type: string}
        network_data: {type: string}
    outputSchema:
      type: object
      additionalProperties: true

  - name: cloudinit.payloads.delete
    capability: write
    requiredScopes: [admin]
    confirmationRequired: true
    inputSchema:
      type: object
      additionalProperties: false
      required: [component_id, confirm]
      properties:
        component_id: {type: string, minLength: 1}
        confirm: {type: boolean, const: true}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.targets.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.targets.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.drivers.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties: {}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.scans.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.scans.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.targets.create
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [name, endpoint, driver]
      properties:
        name: {type: string, minLength: 1}
        endpoint: {type: string, minLength: 1}
        driver: {type: string, minLength: 1}
        credential_id: {type: string}
        insecure_skip_verify: {type: boolean}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.targets.update
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
        name: {type: string}
        endpoint: {type: string}
        driver: {type: string}
        credential_id: {type: string}
        insecure_skip_verify: {type: boolean}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.targets.delete
    capability: write
    requiredScopes: [admin]
    confirmationRequired: true
    inputSchema:
      type: object
      additionalProperties: false
      required: [id, confirm]
      properties:
        id: {type: string, minLength: 1}
        confirm: {type: boolean, const: true}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.target.scan
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
        async: {type: boolean}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.scan.trigger
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [driver]
      properties:
        driver: {type: string, minLength: 1}
        endpoint: {type: string}
        credential_id: {type: string}
        insecure_skip_verify: {type: boolean}
        timeout_seconds: {type: integer, minimum: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: discovery.scan.delete
    capability: write
    requiredScopes: [admin]
    confirmationRequired: true
    inputSchema:
      type: object
      additionalProperties: false
      required: [id, confirm]
      properties:
        id: {type: string, minLength: 1}
        confirm: {type: boolean, const: true}
    outputSchema:
      type: object
      additionalProperties: true

  - name: power.status.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        nodes:
          type: array
          items: {type: string, minLength: 1}
        groups:
          type: array
          items: {type: string, minLength: 1}
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: power.transitions.list
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      properties:
        limit: {type: integer, minimum: 1, maximum: 10000}
        offset: {type: integer, minimum: 0}
    outputSchema:
      type: object
      additionalProperties: true

  - name: power.transitions.get
    capability: read
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
    outputSchema:
      type: object
      additionalProperties: true

  - name: power.transitions.create
    capability: write
    requiredScopes: [admin]
    confirmationConditional:
      field: confirm
      operationField: operation
      requiredWhenOperationIn:
        - ForceOff
        - GracefulShutdown
        - GracefulRestart
        - ForceRestart
        - Nmi
    inputSchema:
      type: object
      additionalProperties: false
      required: [operation]
      properties:
        operation:
          type: string
          enum: [On, ForceOff, GracefulShutdown, GracefulRestart, ForceRestart, Nmi]
        nodes:
          type: array
          items: {type: string, minLength: 1}
        groups:
          type: array
          items: {type: string, minLength: 1}
        dry_run: {type: boolean}
        request_id: {type: string}
        confirm: {type: boolean}
    outputSchema:
      type: object
      additionalProperties: true

  - name: power.transitions.abort
    capability: write
    requiredScopes: [admin]
    confirmationRequired: true
    inputSchema:
      type: object
      additionalProperties: false
      required: [id, confirm]
      properties:
        id: {type: string, minLength: 1}
        confirm: {type: boolean, const: true}
    outputSchema:
      type: object
      additionalProperties: true

  - name: power.transitions.wait
    capability: write
    requiredScopes: [admin]
    inputSchema:
      type: object
      additionalProperties: false
      required: [id]
      properties:
        id: {type: string, minLength: 1}
        timeout_seconds: {type: integer, minimum: 1}
        poll_interval_seconds: {type: integer, minimum: 1}
    outputSchema:
      type: object
      additionalProperties: true
